async function loadDetail() {
        const params = new URLSearchParams(window.location.search);
        const slug = params.get('slug');
        const container = document.getElementById('post-content');
        
        if (!slug) {
            container.innerHTML = "<h1>錯誤</h1><p>網址遺失 slug 參數。</p>";
            return;
        }

        try {
            // 加上時間戳 t=... 避免讀到舊的快取
            // 使用相對路徑 ./posts/ 確保在 GitHub Pages 環境下正確
            const response = await fetch(`./posts/${slug}.md?t=${new Date().getTime()}`);
            
            if (!response.ok) {
                // 如果失敗，嘗試檢查是否是因為副檔名問題
                throw new Error(`找不到檔案: posts/${slug}.md`);
            }
            
            let text = await response.text();
            
            // 移除 Notion 同步過來的 Front Matter (--- 區塊)
            const cleanContent = text.replace(/^---[\s\S]*?---/, '');
            
            // 使用 marked 渲染內容
            container.innerHTML = marked.parse(cleanContent);
            
            // 更新瀏覽器標籤標題
            document.title = slug.split('-').join(' ').toUpperCase() + " | Blog";

        } catch (err) {
            console.error("Fetch error:", err);
            container.innerHTML = `
                <div style="background: #fff5f5; padding: 20px; border-radius: 10px; border: 1px solid #feb2b2;">
                    <h1 style="color: #c53030;">文章載入失敗</h1>
                    <p>原因：${err.message}</p>
                    <p>請檢查 GitHub 倉庫中的 <b>posts/</b> 資料夾，確認是否存在名為 <b>${slug}.md</b> 的檔案。</p>
                    <a href="blog.html" style="color: #3182ce;">← 返回列表重試</a>
                </div>
            `;
        }
    }
    loadDetail();
