<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post - Design with Kirsten</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        body { font-family: -apple-system, sans-serif; line-height: 1.8; max-width: 750px; margin: 0 auto; padding: 60px 20px; color: #333; }
        .back-nav { margin-bottom: 40px; }
        .back-nav a { text-decoration: none; color: #007bff; font-weight: 500; }
        #post-content img { max-width: 100%; height: auto; border-radius: 12px; margin: 20px 0; }
        h1 { font-size: 2.2rem; line-height: 1.3; margin-bottom: 30px; }
        pre { background: #f6f8fa; padding: 16px; border-radius: 8px; overflow: auto; }
        blockquote { border-left: 4px solid #dfe2e5; color: #6a737d; margin: 0; padding-left: 1em; }
    </style>
</head>
<body>
    <div class="back-nav"><a href="blog.html">← Back to Blog</a></div>
    <article id="post-content">內容加載中...</article>

    <script>
        async function loadDetail() {
            const params = new URLSearchParams(window.location.search);
            const slug = params.get('slug');
            const container = document.getElementById('post-content');
            
            if (!slug) {
                container.innerHTML = "<h1>錯誤</h1><p>網址無效。</p>";
                return;
            }

            try {
                // 使用絕對路徑確保穩定，並加上隨機參數防止快取
                const filePath = `https://kirstenyau.github.io/posts/${slug}.md?v=${new Date().getTime()}`;
                const response = await fetch(filePath);
                
                if (!response.ok) throw new Error('無法讀取檔案');
                
                const mdText = await response.text();
                
                // 1. 移除 Notion 產生的標題區塊 (--- 到 ---)
                const cleanContent = mdText.replace(/^---[\s\S]*?---/, '');
                
                // 2. 使用 marked 渲染 Markdown
                container.innerHTML = marked.parse(cleanContent);
                
                // 3. 設定網頁標題
                document.title = slug.replace(/-/g, ' ').toUpperCase();

            } catch (err) {
                console.error(err);
                container.innerHTML = `<h1>載入失敗</h1><p>請確認文章是否存在於 posts/${slug}.md</p>`;
            }
        }
        loadDetail();
    </script>
</body>
</html>
